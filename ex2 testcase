import math

data = [
    ['High','Yes','Yes','Old','Yes'],
    ['High','Yes','No','Young','Yes'],
    ['Normal','Yes','Yes','Old','Yes'],
    ['Low','No','No','Young','No']
]

attributes = ['Fever','Cough','Fatigue','Age']
target_index = 4

def entropy(subset):
    total = len(subset)
    if total == 0: return 0
    yes = sum(1 for row in subset if row[target_index] == 'Yes')
    no = total - yes
    def calc(p): return -p*math.log2(p) if p != 0 else 0
    return calc(yes/total) + calc(no/total)

def info_gain(dataset, attr_index):
    total_entropy = entropy(dataset)
    values = set(row[attr_index] for row in dataset)
    weighted_entropy = 0
    for v in values:
        subset = [row for row in dataset if row[attr_index] == v]
        weighted_entropy += (len(subset)/len(dataset)) * entropy(subset)
    return total_entropy - weighted_entropy

gains = [info_gain(data,i) for i in range(len(attributes))]
best_attr_index = gains.index(max(gains))
best_attr = attributes[best_attr_index]

print("Information Gain:")
for i in range(len(attributes)):
    print(attributes[i], "=", round(gains[i],4))

print("\nRoot Attribute Chosen:", best_attr)

print("\nGenerated Rules:")
for row in data:
    if row[best_attr_index] == 'High' and row[1] == 'Yes':
        print("IF Fever = High AND Cough = Yes → Disease = Yes")
    if row[best_attr_index] == 'Low':
        print("IF Fever = Low → Disease = No")
